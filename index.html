<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Reading Nook</title>
    <link rel="icon" type="image/png" href="book_image.png">
    <!-- Google Fonts for consistent typography across all platforms -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Try to load local config first, then production config -->
    <script src="config.js" onerror="console.log('Local config not found, trying production config')"></script>
    <script src="config.production.js" onerror="console.log('Production config not found')"></script>
</head>
<body>
    <!-- Main Title Bar -->
    <header class="main-header">
        <div class="main-header-content">
            <div class="library-title">
                <img src="book_image.png" alt="Book icon" class="book-icon">
                <h1>My Reading Nook <span class="author-credit">by Alicia Domingo</span></h1>
            </div>
            <div class="header-controls">
                <button id="auth-btn" class="auth-btn" title="Authentication">Authenticate</button>
                <button id="settings-btn" class="settings-btn" title="Settings">Settings</button>
            </div>
        </div>
    </header>

    <div class="app-layout">
        <!-- App Layout -->
        <div class="app-layout">
            <!-- Filters Sidebar -->
            <div class="filters-sidebar">
                <div class="filters-header">
                    <h3>Filters</h3>
                    <button id="clear-filters-btn" class="clear-filters-btn">Clear All</button>
                </div>

                <!-- Status Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="status">
                        <span class="filter-category-title">Status</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options" id="status-options">
                        <label class="filter-option">
                            <input type="checkbox" name="status" value="TBR">
                            <span>To Be Read <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="status" value="Reading">
                            <span>Currently Reading <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="status" value="Finished">
                            <span>Finished <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="status" value="DNF">
                            <span>Did Not Finish <span class="filter-count">(0)</span></span>
                        </label>
                    </div>
                </div>

                <!-- Format Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="format">
                        <span class="filter-category-title">Format</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options" id="format-options">
                        <label class="filter-option">
                            <input type="checkbox" name="format" value="Physical">
                            <span>Physical <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="format" value="Kindle">
                            <span>Kindle <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="format" value="Audiobook">
                            <span>Audiobook <span class="filter-count">(0)</span></span>
                        </label>
                    </div>
                </div>

                <!-- Genre Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="genre">
                        <span class="filter-category-title">Genre</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options scrollable-filter" id="genre-options">
                        <!-- Genre options will be populated dynamically -->
                    </div>
                </div>

                <!-- Author Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="author">
                        <span class="filter-category-title">Author</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options scrollable-filter" id="author-options">
                        <!-- Author options will be populated dynamically -->
                    </div>
                </div>

                <!-- Page Count Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="pageCount">
                        <span class="filter-category-title">Page Count</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options" id="pageCount-options">
                        <!-- Page count options will be populated dynamically -->
                    </div>
                </div>

                <!-- Publisher Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="publisher">
                        <span class="filter-category-title">Publisher</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options scrollable-filter" id="publisher-options">
                        <!-- Publisher options will be populated dynamically -->
                    </div>
                </div>



                <!-- Rating Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="rating">
                        <span class="filter-category-title">Rating</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options" id="rating-options">
                        <label class="filter-option">
                            <input type="checkbox" name="rating" value="1">
                            <span>1 Star <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="rating" value="2">
                            <span>2 Stars <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="rating" value="3">
                            <span>3 Stars <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="rating" value="4">
                            <span>4 Stars <span class="filter-count">(0)</span></span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" name="rating" value="5">
                            <span>5 Stars <span class="filter-count">(0)</span></span>
                        </label>
                    </div>
                </div>

                <!-- Year Read Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="yearRead">
                        <span class="filter-category-title">Year Read</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options" id="yearRead-options">
                        <!-- Year options will be populated dynamically -->
                    </div>
                </div>


                <!-- Date Published Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="datePublished">
                        <span class="filter-category-title">Date Published</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options scrollable-filter" id="datePublished-options">
                        <!-- Date published options will be populated dynamically -->
                    </div>
                </div>

                <!-- Series Filter -->
                <div class="filter-category">
                    <button class="filter-category-toggle" data-category="series">
                        <span class="filter-category-title">Series</span>
                        <span class="filter-toggle-icon">▼</span>
                    </button>
                    <div class="filter-options scrollable-filter" id="series-options">
                        <!-- Series options will be populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <main class="main">
                    <div class="container">

                        <!-- Add Book, Statistics, Search, and Sort Controls -->
                        <div class="sort-controls">
                            <div class="left-controls">
                                <button id="add-book-btn" class="add-book-btn" title="Add New Book">Add Book</button>
                                <button id="statistics-btn" class="statistics-btn" title="Library Statistics">Statistics</button>
                                <div class="search-container">
                                    <input type="text" id="search-input" placeholder="Search by title, author, etc..." class="search-input">
                                    <button id="clear-search" class="clear-search" aria-label="Clear search">×</button>
                                </div>
                            </div>
                            <div class="sort-control">
                                <label for="sort-select">Sort by:</label>
                                <select id="sort-select">
                                    <option value="author-series-asc" selected>Default</option>
                                    <option value="title-asc">Title (A-Z)</option>
                                    <option value="title-desc">Title (Z-A)</option>
                                    <option value="author-asc">Author (A-Z)</option>
                                    <option value="author-desc">Author (Z-A)</option>
                                    <option value="dateAdded-desc">Date Added (Newest First)</option>
                                    <option value="dateAdded-asc">Date Added (Oldest First)</option>
                                    <option value="datePublished-desc">Date Published (Newest First)</option>
                                    <option value="datePublished-asc">Date Published (Oldest First)</option>
                                    <option value="dateStarted-desc">Date Started (Recent First)</option>
                                    <option value="dateStarted-asc">Date Started (Oldest First)</option>
                                    <option value="dateFinished-desc">Date Finished (Recent First)</option>
                                    <option value="dateFinished-asc">Date Finished (Oldest First)</option>
                                    <option value="pageCount-desc">Page Count (Most Pages)</option>
                                    <option value="pageCount-asc">Page Count (Least Pages)</option>
                                </select>
                            </div>
                        </div>



                <div class="action-section" style="display: none;">
                    <!-- Hidden export/import functionality - buttons moved to search section -->
                    <button id="export-btn" class="export-btn">Export Library</button>
                    <label for="import-file" class="import-btn">Import Library</label>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                </div>
            </section>




            <!-- Book Count Display -->
            <div class="book-count-container">
                <span id="book-count" class="book-count">Showing 0 books</span>
            </div>

            <!-- Bookshelf Display -->
            <section class="bookshelf-container">
                <div id="bookshelf" class="bookshelf">
                    <!-- Books will be dynamically inserted here -->
                </div>
            </section>

                    <!-- Empty State -->
                    <div id="empty-state" class="empty-state hidden">
                        <h3>📚 No Books Found</h3>
                        <p>No books found matching your current search criteria.<br>
                        Try adjusting your filters or search terms.</p>
                    </div>
                    </div>
                </main>
            </div>
        </div>


    </main>

    <!-- Book Detail Modal -->
    <div id="book-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" aria-label="Close modal">×</button>
            <div class="modal-body">
                <!-- Modal content will be dynamically inserted -->
            </div>
        </div>
    </div>





    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" aria-label="Close modal">×</button>
            <div class="modal-body">
                <h2>Settings</h2>
                <div class="settings-container">
                    <div class="setting-item">
                        <label class="setting-label">
                            <span>Dark Mode</span>
                            <div class="toggle-switch">
                                <input type="checkbox" id="dark-mode-toggle" class="toggle-input">
                                <span class="toggle-slider"></span>
                            </div>
                        </label>
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">
                            <span>Filter Bar Size</span>
                            <div class="size-selector">
                                <input type="radio" id="filter-size-small" name="filter-size" value="small" checked>
                                <label for="filter-size-small" class="size-option">Small</label>
                                <input type="radio" id="filter-size-medium" name="filter-size" value="medium">
                                <label for="filter-size-medium" class="size-option">Medium</label>
                                <input type="radio" id="filter-size-large" name="filter-size" value="large">
                                <label for="filter-size-large" class="size-option">Large</label>
                            </div>
                        </label>
                    </div>


                </div>
            </div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="auth-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" aria-label="Close modal">×</button>
            <div class="modal-body">
                <h2>Authentication</h2>
                <div class="auth-status">
                    <span id="auth-status-text">Not Authenticated</span>
                    <button id="logout-btn" class="btn-secondary logout-btn hidden">Logout</button>
                </div>

                <!-- Authentication Form (shown when not authenticated) -->
                <div id="auth-form-container" class="auth-form-container">
                    <p class="auth-description">Enter your credentials to add or edit books:</p>
                    <form id="auth-form">
                        <div class="form-group">
                            <label for="auth-username">Username:</label>
                            <input type="text" id="auth-username" placeholder="Enter username..." required autocomplete="username">
                        </div>
                        <div class="form-group">
                            <label for="auth-password">Password:</label>
                            <input type="password" id="auth-password" placeholder="Enter password..." required autocomplete="current-password">
                        </div>
                        <div class="auth-error hidden" id="auth-error">
                            Invalid credentials. Please try again.
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn-primary">Authenticate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Modal -->
    <div id="statistics-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content statistics-modal-content">
            <button class="modal-close" aria-label="Close modal">×</button>
            <div class="modal-body">
                <h2>Library Statistics</h2>
                <div class="stats-container">
                    <div class="stat-item">
                        <span class="stat-label">Total Books</span>
                        <span class="stat-value" id="total-books">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Books Read</span>
                        <span class="stat-value" id="books-read">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Currently Reading</span>
                        <span class="stat-value" id="currently-reading">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">To Be Read</span>
                        <span class="stat-value" id="to-be-read">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Did Not Finish</span>
                        <span class="stat-value" id="dnf-books">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Total Pages</span>
                        <span class="stat-value" id="total-pages">0</span>
                    </div>

                    <div class="stat-item">
                        <span class="stat-label">Average Rating</span>
                        <span class="stat-value" id="average-rating">N/A</span>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Add Book Modal -->
    <div id="add-book-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" aria-label="Close modal">×</button>
            <div class="modal-body">
                <h2>Add New Book</h2>
                <form id="add-book-form">
                    <div class="form-with-preview">
                        <div class="form-fields">
                            <div class="form-group">
                                <label for="book-title">Title:</label>
                                <input type="text" id="book-title" placeholder="Enter book title..." required>
                            </div>
                            <div class="form-group">
                                <label for="book-isbn">ISBN-13:</label>
                                <input type="text" id="book-isbn" placeholder="Enter ISBN-13..." maxlength="20" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="book-author">Author:</label>
                                    <input type="text" id="book-author" placeholder="Enter author name..." required>
                                </div>
                                <div class="form-group">
                                    <label for="book-genre">Genre:</label>
                                    <select id="book-genre" required>
                                        <option value="">Select a genre...</option>

                                        <!-- Fiction Genres -->
                                        <optgroup label="Fiction">
                                            <option value="Literary Fiction">Literary Fiction</option>
                                            <option value="Contemporary Fiction">Contemporary Fiction</option>
                                            <option value="Historical Fiction">Historical Fiction</option>
                                            <option value="Science Fiction">Science Fiction</option>
                                            <option value="Fantasy">Fantasy</option>
                                            <option value="Mystery">Mystery</option>
                                            <option value="Thriller">Thriller</option>
                                            <option value="Suspense">Suspense</option>
                                            <option value="Romance">Romance</option>
                                            <option value="Horror">Horror</option>
                                            <option value="Adventure">Adventure</option>
                                            <option value="Western">Western</option>
                                            <option value="Crime">Crime</option>
                                            <option value="Detective">Detective</option>
                                            <option value="Dystopian">Dystopian</option>
                                            <option value="Magical Realism">Magical Realism</option>
                                        </optgroup>

                                        <!-- Non-Fiction Genres -->
                                        <optgroup label="Non-Fiction">
                                            <option value="Biography">Biography</option>
                                            <option value="Autobiography">Autobiography</option>
                                            <option value="Memoir">Memoir</option>
                                            <option value="History">History</option>
                                            <option value="True Crime">True Crime</option>
                                            <option value="Self-Help">Self-Help</option>
                                            <option value="Health & Wellness">Health & Wellness</option>
                                            <option value="Business">Business</option>
                                            <option value="Finance">Finance</option>
                                            <option value="Psychology">Psychology</option>
                                            <option value="Philosophy">Philosophy</option>
                                            <option value="Religion & Spirituality">Religion & Spirituality</option>
                                            <option value="Science">Science</option>
                                            <option value="Technology">Technology</option>
                                            <option value="Politics">Politics</option>
                                            <option value="Travel">Travel</option>
                                            <option value="Cooking">Cooking</option>
                                            <option value="Art & Design">Art & Design</option>
                                        </optgroup>

                                        <!-- Age-Specific Genres -->
                                        <optgroup label="Age Categories">
                                            <option value="Young Adult">Young Adult</option>
                                            <option value="New Adult">New Adult</option>
                                            <option value="Children's">Children's</option>
                                            <option value="Middle Grade">Middle Grade</option>
                                            <option value="Picture Books">Picture Books</option>
                                        </optgroup>

                                        <!-- Specialized Genres -->
                                        <optgroup label="Specialized">
                                            <option value="Poetry">Poetry</option>
                                            <option value="Drama">Drama</option>
                                            <option value="Essays">Essays</option>
                                            <option value="Short Stories">Short Stories</option>
                                            <option value="Graphic Novel">Graphic Novel</option>
                                            <option value="Comics">Comics</option>
                                            <option value="Reference">Reference</option>
                                            <option value="Textbook">Textbook</option>
                                            <option value="Guide">Guide</option>
                                            <option value="Humor">Humor</option>
                                        </optgroup>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="book-image-url">Image URL:</label>
                                    <input type="url" id="book-image-url" placeholder="Enter cover image URL..." required>
                                </div>
                                <div class="form-group">
                                    <label for="book-pages">Page Count:</label>
                                    <input type="number" id="book-pages" placeholder="Number of pages..." min="1" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="book-synopsis">Synopsis:</label>
                                <textarea id="book-synopsis" placeholder="Enter book synopsis..." maxlength="1200" required></textarea>
                                <div class="character-count">
                                    <span id="synopsis-count">0</span>/1200 characters
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="book-status">Status:</label>
                                    <select id="book-status" required>
                                        <option value="">Select a status...</option>
                                        <option value="TBR">To Be Read</option>
                                        <option value="Reading">Currently Reading</option>
                                        <option value="Finished">Finished</option>
                                        <option value="DNF">Did Not Finish</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="book-publisher">Publisher:</label>
                                    <input type="text" id="book-publisher" placeholder="Enter publisher..." required>
                                </div>
                            </div>
                            <div id="date-started-row" class="form-row" style="display: none;">
                                <div class="form-group">
                                    <label for="book-date-started">Date Started:</label>
                                    <input type="date" id="book-date-started">
                                </div>
                                <div class="form-group" id="date-finished-field" style="display: none;">
                                    <label for="book-date-finished">Date Finished:</label>
                                    <input type="date" id="book-date-finished">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="book-date-published">Date Published:</label>
                                    <input type="date" id="book-date-published" placeholder="Publication date..." required>
                                </div>
                                <div class="form-group">
                                    <label>My Rating: <span class="optional-hint">(Required for finished books)</span></label>
                                    <div class="star-rating" id="star-rating">
                                        <span class="star" data-rating="1">★</span>
                                        <span class="star" data-rating="2">★</span>
                                        <span class="star" data-rating="3">★</span>
                                        <span class="star" data-rating="4">★</span>
                                        <span class="star" data-rating="5">★</span>
                                    </div>
                                    <input type="hidden" id="book-rating" value="">
                                </div>
                            </div>

                        </div>
                        <div class="image-preview">
                            <div class="preview-container">
                                <img id="book-cover-preview" src="" alt="Book cover preview" style="display: none;">
                                <div id="preview-placeholder" class="preview-placeholder">
                                    <span>📖</span>
                                    <p>Book cover will appear here</p>
                                </div>
                            </div>
                            <div class="form-group format-group">
                                <label>Format:</label>
                                <div class="format-checkboxes">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="format" value="Physical" id="format-physical" required>
                                        <span>Physical</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="format" value="Kindle" id="format-kindle">
                                        <span>Kindle</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="format" value="Audiobook" id="format-audiobook">
                                        <span>Audiobook</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="book-series">Part of Series:</label>
                                <select id="book-series" required>
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>

                            <div id="series-fields" class="series-fields" style="display: none;">
                                <div class="form-group">
                                    <label for="series-name">Series Name:</label>
                                    <input type="text" id="series-name" placeholder="Enter series name...">
                                </div>
                                <div class="form-group">
                                    <label for="series-number">Book Number in Series:</label>
                                    <input type="number" id="series-number" min="0.1" step="0.1" placeholder="Enter series number...">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="cancel-add-book">Cancel</button>
                        <button type="submit" class="btn-primary">Add Book</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


                </div>
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <p>&copy; 2025 My Reading Nook by Alicia Domingo. All rights reserved.</p>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
